<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="renderer" content="webkit">


    <meta name="keywords" content="">
    <meta name="description" content="">

    <!--[if lt IE 9]>
    <meta http-equiv="refresh" content="0;ie.html" />
    <![endif]-->

    <link rel="shortcut icon" href="favicon.ico">
    <link th:href="@{/css/bootstrap.min.css}" rel="stylesheet">
    <link th:href="@{/css/font-awesome.css}" rel="stylesheet">
    <link th:href="@{/css/plugins/bootstrap-table/bootstrap-table.min.css}" rel="stylesheet">
    <link th:href="@{/css/animate.css}" rel="stylesheet">
    <link th:href="@{/css/style.css}" rel="stylesheet">
    <link th:href="@{/layui/css/layui.css}" rel="stylesheet">
</head>

<body class="fixed-sidebar full-height-layout gray-bg" style="overflow:hidden">
    <div id="wrapper">
        <!--左侧导航开始-->
        <nav class="navbar-default navbar-static-side" role="navigation">
            <div class="nav-close"><i class="fa fa-times-circle"></i>
            </div>
            <div class="sidebar-collapse">
                <ul class="nav" id="side-menu">
                    <li class="nav-header">
                        <div class="dropdown profile-element">
                            <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                                <span class="clear">
                                    <span class="block m-t-xs" style="font-size:20px;">
                                        <i class="fa fa-area-chart"></i>
                                        <strong class="font-bold">教师端</strong>
                                    </span>
                                </span>
                            </a>
                        </div>
                        <div class="logo-element">教师端
                        </div>
                    </li>
                    <li class="hidden-folded padder m-t m-b-sm text-muted text-xs">
                        <span class="ng-scope">分类</span>
                    </li>
                    <li>
                        <a href="#"><i class="fa fa-flask"></i> <span class="nav-label">实训课程信息管理</span><span class="fa arrow"></span></a>
                        <ul class="nav nav-second-level">
                            <li><a class="J_menuItem active" href="http://localhost:8080/teacher/project">课程基本信息管理</a>
                            </li>
                            <li><a class="J_menuItem" href="http://localhost:8080/basicInfo/selectCount">已选课程统计表</a>
                            </li>
                            <li><a class="J_menuItem" href="http://localhost:8080/basicInfo/project">我的课程</a>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a href="#"><i class="fa fa-table"></i> <span class="nav-label">实训教师信息</span><span class="fa arrow"></span></a>
                        <ul class="nav nav-second-level active">
                            <li><a class="J_menuItem" href="http://localhost:8080/basicInfo/teacher" >教师信息</a>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a href="#"><i class="fa fa-flask"></i> <span class="nav-label">实训学生管理</span><span class="fa arrow"></span></a>
                        <ul class="nav nav-second-level">
                            <li><a class="J_menuItem active" href="http://localhost:8080/basicInfo/student">学生基本信息</a>
                            </li>
                            <li><a class="J_menuItem" href="http://localhost:8080/teacher/student">我的学生</a>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a href="#"><i class="fa fa-flask"></i> <span class="nav-label">实训课程评价</span><span class="fa arrow"></span></a>
                        <ul class="nav nav-second-level">
                            <li><a class="J_menuItem active" href="http://localhost:8080/teacher/appraise">学生评价</a>
                            </li>
                            <li><a class="J_menuItem" href="http://localhost:8080/teacher/feedback">学生意见反馈列表</a>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a href="#"><i class="fa fa-flask"></i> <span class="nav-label">实训成绩管理</span><span class="fa arrow"></span></a>
                        <ul class="nav nav-second-level">
                            <li><a class="J_menuItem active" href="http://localhost:8080/teacher/score">学生评分</a>
                            </li>
                            <li><a class="J_menuItem" href="http://localhost:8080/basicInfo/score">学生成绩统计</a>
                            </li>
                        </ul>
                    </li>

                </ul>
            </div>
        </nav>
        <!--左侧导航结束-->
        <!--右侧部分开始-->
        <div id="page-wrapper" class="gray-bg dashbard-1" >
            <div class="row border-bottom">
                <nav class="navbar navbar-static-top" role="navigation" style="margin-bottom: 0">
                    <div class="navbar-header"><a class="navbar-minimalize minimalize-styl-2 btn btn-info " href="#"><i class="fa fa-bars"></i> </a>
                        <form role="search" class="navbar-form-custom" method="post" action="search_results.html">
                            <div class="form-group">
                                <input type="text" placeholder="请输入您需要查找的内容 …" class="form-control" name="top-search" id="top-search">
                            </div>
                        </form>
                    </div>
                    <ul class="nav navbar-top-links navbar-right">
                        <li class="dropdown">

                            <a class="dropdown-toggle count-info" data-toggle="dropdown"
                            >
                                <i class="fa fa-user">[[${session.systemUserSession.userName}]]</i>
                            </a>
                            <ul class="dropdown-menu dropdown-alerts" style="width: 100px">
                                <li><a  th:onclick="editInfo()" >修改信息</a></li>
                                </li>
                                <li class="divider"></li>
                                <li><a  th:onclick="editPassword()" >修改密码</a></li>
                                </li>

                            </ul>

                        </li>
                    </ul>
                </nav>
            </div>
            <div class="row J_mainContent" id="content-main">
                <iframe id="J_iframe" width="100%" height="100%"  frameborder="0"  seamless></iframe>
            </div>
        </div>
        <!--右侧部分结束-->
    </div>
    <div id="add-edit" style="display: none;padding: 20px 20px 0px 20px">
        <form class="layui-form"  >
            <input type="hidden"  id="id" style="width: 240px"   class="layui-input">
            <div class="layui-form-item center" >
                <label class="layui-form-label" style="width: 100px" >教师编号：</label>
                <div class="layui-input-block">
                    <input type="text"  id="userAccount" style="width: 240px"   class="layui-input"  lay-verify="required|number" required >
                </div>
            </div>
            <div class="layui-form-item center" >
                <label class="layui-form-label" style="width: 100px" >姓名：</label>
                <div class="layui-input-block">
                    <input type="text"  id="userName" style="width: 240px"   class="layui-input"  lay-verify="required" required >
                </div>
            </div>
            <div class="layui-form-item center" >
                <label class="layui-form-label" style="width: 100px" >邮箱：</label>
                <div class="layui-input-block">
                    <input type="text"  id="userEmail" style="width: 240px"   class="layui-input"  lay-verify="required|email" required >
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label" style="width: 100px">性别：</label>
                <div class="layui-input-block">
                    <input type="radio" name="userSex" value="0" title="男">
                    <input type="radio" name="userSex" value="1" title="女" checked>
                </div>
            </div>
            <div class="layui-form-item center" >
                <label class="layui-form-label" style="width: 100px" >手机号：</label>
                <div class="layui-input-block">
                    <input type="text"  id="userPhone" style="width: 240px"   class="layui-input"  lay-verify="required|phone|number" required >
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label" style="width: 120px;margin-left: -20px">校内(校外)：</label>
                <div class="layui-input-block">
                    <input type="radio" id="isInside" name="isInside" value="0" title="校内" checked>
                    <input type="radio" id="isInside" name="isInside" value="1" title="校外" >
                </div>
            </div>
            <div class="layui-form-item" >
                <label class="layui-form-label" style="width: 100px">学院：</label>
                <div class="layui-input-block" id="collegeId" style="width: 240px">

                </div>
            </div>
            <div class="layui-form-item">
                <div class="layui-input-block">
                    <button class="layui-btn" lay-submit lay-filter="save" id="submitBtn">修改</button>
                    <button  class="layui-btn layui-btn-primary" id="closeBtn" >取消</button>
                </div>
            </div>
        </form>
    </div>
    <div id="changePassword" style="display: none;padding: 20px 20px 0px 20px">
        <form class="layui-form"  >
            <input type="hidden"  id="id" style="width: 240px"   class="layui-input" th:value="${session.systemUserSession.id}">
            <input type="hidden"  id="userAccount" style="width: 240px"   class="layui-input" th:value="${session.systemUserSession.userAccount}">
            <div class="layui-form-item center" >
                <label class="layui-form-label" style="width: 100px" >新密码：</label>
                <div class="layui-input-block">
                    <input type="text"  id="userPassword" style="width: 240px"   class="layui-input"  lay-verify="required" required >
                </div>
            </div>
            <div class="layui-form-item center" >
                <label class="layui-form-label" style="width: 100px" >再次输入：</label>
                <div class="layui-input-block">
                    <input type="text"  id="userPassword1" style="width: 240px"   class="layui-input"  lay-verify="pass"  required >
                </div>
            </div>
            <div class="layui-form-item">
                <div class="layui-input-block">
                    <button class="layui-btn" lay-submit lay-filter="change" >修改</button>
                    <button  class="layui-btn layui-btn-primary" id="closeBtn" >取消</button>
                </div>
            </div>
        </form>
    </div>
    <!-- 全局js -->
    <script th:src="@{/js/jquery.min.js}"></script>
    <script th:src="@{/js/bootstrap.min.js}"></script>
    <script th:src="@{/js/plugins/metisMenu/jquery.metisMenu.js}"></script>
    <script th:src="@{/js/plugins/slimscroll/jquery.slimscroll.min.js}"></script>
    <script th:src="@{/js/plugins/layer/layer.min.js}"></script>

    <script th:src="@{/js/hAdmin.js}"></script>
    <script type="text/javascript" th:src="@{/js/index.js}"></script>

    <!-- 第三方插件 -->
    <script th:src="@{/js/plugins/pace/pace.min.js}"></script>
    <!-- 自定义js -->
    <script th:src="@{/js/content.js}"></script>
    <script th:src="@{/js/common.js}"></script>

    <!-- Bootstrap table -->
    <script th:src="@{/js/plugins/bootstrap-table/bootstrap-table.min.js}"></script>
    <script th:src="@{/js/plugins/bootstrap-table/bootstrap-table-mobile.min.js}"></script>
    <script th:src="@{/js/plugins/bootstrap-table/locale/bootstrap-table-zh-CN.min.js}"></script>
    <script th:src="@{/layer/layer.js}"></script>
    <script th:src="@{/layui/layui.js}"></script>
    <script th:src="@{/js/xm-select.js}"></script>
    <script th:inline="javascript">
        var xm=xmSelect.render({
            el: '#collegeId',
            language: 'zn',
            radio: true,
            clickClose: true,
            model: {
                icon: 'hidden',
                label: {
                    type: 'text'
                }
            },
            data: []
        })
        function editPassword() {
            layer.open({
                type: 1,
                title:"编辑学生信息",
                closeBtn: false,
                shift: 2,
                area: ['450px', '300px'],
                shadeClose: true,
                content: $("#changePassword")


            });

        }
        function editInfo() {
            var id = [[${session.systemUserSession.id}]]
            var userName = [[${session.systemUserSession.userName}]]
            var userAccount = [[${session.systemUserSession.userAccount}]]
            var userEmail = [[${session.systemUserSession.userEmail}]]
            var userSex = [[${session.systemUserSession.userSex}]]
            var isInside = [[${session.systemUserSession.isInside}]]
            var userPhone = [[${session.systemUserSession.userPhone}]]
            var collegeId = [[${session.systemUserSession.collegeId}]]
            layer.open({
                type: 1,
                title:"编辑学生信息",
                closeBtn: false,
                shift: 2,
                area: ['450px', '600px'],
                shadeClose: true,
                content: $("#add-edit"),
                success: function(layero, index){
                    $("#add-edit").val('1')
                    $("#add-edit").find('#id').val(id)
                    $("#add-edit").find('#userAccount').val(userAccount)
                    $("#add-edit").find('#userName').val(userName)
                    $("#add-edit").find('#userEmail').val(userEmail)
                    if(userSex=='0'){
                        $("input[name='userSex']")[0].checked = true;
                    }else if(userSex=='1'){
                        $("input[name='userSex']")[1].checked = true;
                    }
                    if(isInside=='0'){
                        $("input[name='isInside']")[0].checked = true;
                    }else if(isInside=='1'){
                        $("input[name='isInside']")[1].checked = true;
                    }
                    layui.form.render('radio');
                    $("#add-edit").find('#userPhone').val(userPhone)
                    roleList(collegeId)
                },
                yes:function(){
                }
            });
        }
        layui.use(['layer', 'form'], function () {
            var layer = layui.layer,
                $ = layui.jquery,
                form = layui.form;
            form.verify({

                pass: function(value) {
                    if ($("#changePassword").find('#userPassword').val() !== value)
                        return '两次密码输入不一致！';
                }
            });
            form.on('submit(save)', function () {
                var id  = $("#add-edit").find('#id').val()
                var userAccount= $("#add-edit").find('#userAccount').val()
                var userName=  $("#add-edit").find('#userName').val()
                var userEmail=$("#add-edit").find('#userEmail').val()
                var isInside = $('input[name="isInside"]:checked ').val();
                var userSex = $('input[name="userSex"]:checked ').val();
                var userPhone=$("#add-edit").find('#userPhone').val();
                var userStatus='1'
                var flag='2'
                var xmList = xmSelect.get('#collegeId',true);
                var collegeId=xmList.getValue('valueStr');
                var user={
                    id:id,
                    userAccount:userAccount,
                    userName:userName,
                    userEmail:userEmail,
                    userSex:userSex,
                    userPhone:userPhone,
                    isInside:isInside,
                    collegeId:collegeId,
                    flag:flag,
                    userStatus:userStatus
                }
                var url="http://localhost:8080/system/user/update";
                submit(JSON.stringify(user),url);

                return false;
            })
            form.on('submit(change)', function () {
                var id  = $("#changePassword").find('#id').val()
                var userAccount= $("#changePassword").find('#userAccount').val()
                var userPassword=  $("#changePassword").find('#userPassword').val()

                var user={
                    id:id,
                    userAccount:userAccount,
                    userPassword:userPassword
                }
                var url="http://localhost:8080/system/user/changePwd";
                submit(JSON.stringify(user),url);

                return false;
            })
            var obj = document.getElementById('closeBtn');
            obj.addEventListener('click', function cancel(){
                CloseWin();
            });
        })
        //提交
        function submit(dateInfo,url){
            $.ajax({
                "url":url,
                "type":"post",
                "data":dateInfo,
                "dataType":"json",
                "contentType":"application/json;charset=UTF-8",
                "success":function (response) {
                    var result=response.code;
                    if(result==200){

                        CloseWin()
                        layer.msg(response.msg);
                    }
                    else {
                        CloseWin()
                        layer.msg(response.msg);
                    }
                },
                "error":function (response) {
                    layer.msg(response.code+" "+response.msg);
                }
            })
        };


        //关闭页面
        function CloseWin(){

            layer.closeAll();
            parent.location.href="http://localhost:8080/teacher"
        }
        function roleList(roleId) {
            $.ajax({
                "url":"http://localhost:8080/basicData/college/list",
                "type":"get",
                "dataType":"json",
                "success":function (response) {
                    var result=response.code;
                    var list=response.data;
                    if(result==200){
                        if(roleId!=''){
                            for (var i = 0; i < list.length; i++){
                                if(list[i].value==roleId){
                                    list[i].selected=true
                                }

                            }
                        }
                        xm.update({
                            data: list
                        })

                    }
                    else {
                        layer.msg(response.msg);
                    }
                },
                "error":function (response) {
                    layer.msg(response.code+" "+response.msg);
                }
            })
        }


    </script>

</body>

</html>
